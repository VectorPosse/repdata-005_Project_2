# Human and Economic Costs of Severe Weather Events

## Synopsis

The NOAA records data on U.S. weather. Storms and other extreme weather events are reported along with their associated effects on human life, injury, property, and crops. In this report, we explore the data from 1950--2011 and determine those weather events that have caused the most harm in terms of human and economic costs.

## Data Processing

We load the `dplyr` package for data manipulation, the `lubridate` package for working with dates, and the `ggplot2` package for graphing. We will also load Winston Chang's helpful `multiplot` function:


```r
library("dplyr")
library("lubridate")
library("ggplot2")
# Multiple plot function
#
# ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)
# - cols:   Number of columns in layout
# - layout: A matrix specifying the layout. If present, 'cols' is ignored.
#
# If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),
# then plot 1 will go in the upper left, 2 will go in the upper right, and
# 3 will go all the way across the bottom.
#
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  require(grid)

  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)

  numPlots = length(plots)

  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                    ncol = cols, nrow = ceiling(numPlots/cols))
  }

 if (numPlots==1) {
    print(plots[[1]])

  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))

    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))

      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}
```


Although the data comes in a compressed format, `read.csv` has no trouble parsing it.


```r
storm_data_raw <- read.csv("repdata-data-StormData.csv.bz2",
                           stringsAsFactors = FALSE)
```

We will `select` only the columns that pertain to our questions:

* `EVTYPE`: the event type,
* `BGN_DATE`: the date of the event,
* `FATALITIES`: the number of fatalities that resulted,
* `INJURIES`: the number of injuries that resulted,
* `PROPDMG`: an estimate for the amount of property damage,
* `PROPDMGEXP`: a "multiplier" extension for the amount in `PROPDMG`,
* `CROPDMG`: an estimate for the amount of crop damage,
* `CROPDMGEXP`: a "multiplier" extension for the amount in `CROPDMG`,
* `REMARKS`: remarks added by the person recording the data.


```r
storm_data <- storm_data_raw %>%
    select(EVTYPE, BGN_DATE, FATALITIES, INJURIES, PROPDMG, PROPDMGEXP,
           CROPDMG, CROPDMGEXP, REMARKS)
```

First, we'll deal with the `BGN_DATE` variable. As we're not concerned about the time of day (and it's not even recorded in many cases), we will extract only the date.


```r
date <- storm_data$BGN_DATE %>%
    strsplit(" ") %>%
    unlist %>%
    matrix(nrow = length(storm_data$BGN_DATE), ncol = 2, byrow = TRUE)
date <- as.Date(date[,1], format = "%m/%d/%Y")
storm_data <- storm_data %>%
    mutate(date = date)
rm(date)
```


Next, we'll calculate the property and crop damage in dollars. In the instructions for storm data preparation (located [here](https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2Fpd01016005curr.pdf)), we read,

>Estimates should be rounded to three significant digits, followed by an alphabetical character signifying the magnitude of the number, i.e., 1.55B for $1,550,000,000. Alphabetical characters used to signify magnitude include K for thousands, M for millions, and B for billions.

Therefore, to get accurate damage estimates, we need to multiply our damages by the appropriate factor.

The bad news is that there is some messiness in the variables `PROPDMGEXP` and `CROPDMGEXP`.


```r
table(storm_data$PROPDMGEXP)
```

```
## 
##             -      ?      +      0      1      2      3      4      5 
## 465934      1      8      5    216     25     13      4      4     28 
##      6      7      8      B      h      H      K      m      M 
##      4      5      1     40      1      6 424665      7  11330
```

```r
table(storm_data$CROPDMGEXP)
```

```
## 
##             ?      0      2      B      k      K      m      M 
## 618413      7     19      1      9     21 281832      1   1994
```

The good news is that there aren't many too many cases that have strange entries in this field. One possibiility is that the numerical digits may have been recorded by people assuming that this field was for the power of ten required for scientific notation (i.e., $3000 = 3.00 \times 10^{3}$). This would be especially problematic for our analysis for large powers of 10, indicating dollar figures possibly in the millions or more. We examine these specific entries for clues:


```r
storm_data %>%
    filter(PROPDMGEXP %in% 5:8) %>%
    select(EVTYPE, PROPDMG, PROPDMGEXP, REMARKS) %>%
    arrange(PROPDMGEXP)
```

```
##                         EVTYPE PROPDMG PROPDMGEXP
## 1  URBAN/SMALL STREAM FLOODING     0.0          5
## 2                   HEAVY SNOW     1.7          5
## 3                         HAIL    30.0          5
## 4           THUNDERSTORM WINDS     0.1          5
## 5           THUNDERSTORM WINDS     0.0          5
## 6           THUNDERSTORM WINDS    10.0          5
## 7                      TORNADO    14.0          5
## 8           THUNDERSTORM WINDS    12.0          5
## 9                      TORNADO    88.0          5
## 10          THUNDERSTORM WINDS    12.0          5
## 11                   LIGHTNING     3.0          5
## 12                   LIGHTNING     0.2          5
## 13                 FLASH FLOOD    12.0          5
## 14          THUNDERSTORM WINDS     1.0          5
## 15                   LIGHTNING     1.0          5
## 16                    FLOODING     5.2          5
## 17                        HAIL     0.0          5
## 18                        HAIL     0.0          5
## 19                        HAIL     0.0          5
## 20                        HAIL     0.0          5
## 21                        HAIL     0.0          5
## 22                        HAIL     0.0          5
## 23                        HAIL     0.0          5
## 24          THUNDERSTORM WINDS     0.0          5
## 25                     TORNADO     0.2          5
## 26                    FLOODING     0.7          5
## 27                   LIGHTNING    13.0          5
## 28                 FLASH FLOOD     6.4          5
## 29          THUNDERSTORM WINDS    24.0          6
## 30          THUNDERSTORM WINDS    26.0          6
## 31          THUNDERSTORM WINDS    15.0          6
## 32                     TORNADO     0.0          6
## 33          THUNDERSTORM WINDS    14.0          7
## 34                 FLASH FLOOD    68.0          7
## 35                     TORNADO     0.0          7
## 36                        HAIL     0.0          7
## 37                   LIGHTNING     0.0          7
## 38                        HAIL     0.0          8
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              REMARKS
## 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Street flooding reported in Palm Springs at Sunrise and Ramone St. Power outages in the area due to lightning. Additional heavy rain fell in the San Jacinto and Santa Rosa Mountains, with over an inch of rain in a 1/2 hour period. 
## 2  All Mountains, N.E. Front Range,A strong, very moist and slow moving winter storm system took aim on Colorado.  The mountains received the brunt of the storm where they measured the snow in feet.  As for the high country, all mountain ranges received at least three feet of snow with some locations in the Elk Mountains, collecting six to eight feet (72 to 96 inches).  Gothic Mountain collected 95 inches, with 24 inches of it falling on the 12th.  The new snow in the high country prompted the Colorado Avalanche Information Center to issue an extreme avalanche danger warning on the 12th for the entire Colorado backcountry.  Two people were killed by avalanches during the week.  The first fatality was a female backcountry skier who skied into avalanche danger in the Dry Gulch drainage near the east entrance to the Eisenhower Tunnel.  The other fatality was a man who was buried in his teepee residence in the Conundrum Creek valley south of Aspen on the morning of the 14th.  Road closures were common in the high country due to poor visibilities and avalanches.  Locations at or near the Passes of Berthoud, Coal Bank, Keebler, Loveland, McClure, Molas, Monarrowch, Red Mountain, and Wolf Creek were closed for a time during the storm.  In addition, Interstate 70 was closed on the 12th when an avalanche crossed the westbound lanes west of the Eisenhower Tunnel.  The interstate was reopened later that evening.  The Colorado Department of Transportation superintendent in charge of helicopter avalanche control missions, said there were more large avalanches in the backcountry then he had ever seen in his 20 years of service at CDOT.  On the afternoon of the 14th, an avalanche broke free and caused extensive structural damage to 10 condominium units near Crested Butte.  Earlier that day, west of Crested Butte on Keebler Pass, an avalanche broke and buried and damaged numerous snowmobiles parked at the Kebler Pass trailhead.  Six miles to the northwest of Crested Butte near Pittsburg, a 2,500 square foot, two-story summer home, valued between $250,000 and $300,000 was destroyed from an avalanche that had been naturally triggered off the southeast side of Purple Mountian.  Numerous damaged structures, of a lesser degree, had been reported at a few condominium complexes in the central mountains.  Eight miles west of Tennessee Pass, an avalanche swept away a 20 by 50 foot metal building off the foundation.  An avalanche three miles south of Pando, knocked two boxcars off of the rails. \nArctic air, which moved southward out of the northern plains, provided a decent supply of upslope flow for eastern Colorado.  At lower elevations, including the foothills and northern front range, the snow started falling the morning of the 10th.  Most of the snow had fallen during the 24-hour period ofter the onset.  Storm accumulation amounts ranged between \nLocations in and near the foothills received the most snow as they collected between 10 and 15 inches.  Golden and south sections of Boulder collected 15 and 14 inches respectively.  Snow amounts in northeast colorado to the east of Greeley were between three and six inches. 
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Pea- to nickel-size hail together with torrential rainfall pummeled the town of Gilcrest and vicinity, approximately eight miles south of Greeley.  Most crops, trees and other vegetation around Gilcrest had been either flattened or stripped of leaves.  Although it rained for over two hours, the most intense rainfall which was coupled with hail lasted approximately 45 minutes.  About 22 homes and farms sustained damaging flood waters ranging in depth from two to four feet.  A Gilcrest sewer pump station had stopped due to a direct lightning strike.  Six hundred panels of glass had been broken at a Fort Lupton Greenhouse.  Total damage storm was estimated at $18 million in Weld County for property with an additional $15 million for crops.  In Morgan County the damage was $12.5 million for property with $9.8 million for crops on 22,000 acres. Frequent rainfall events over the past several weeks, mainly in the form of heavy afternoon showers and thunderstorms, had saturated the ground at many locations of the Front Range Foothills and adjacent eastern Plains.  A trend of upper level instability along with significant amounts moisture had created the afternoon showers and thunderstorms dropping anywhere between one and three and one-half inches of rainfall each afternoon and evening in their paths.  The areas most affected were locations near the South Platte River and small creeks and streams leading into the South Platte River.  The heavy rains, which started in early to middle May were most intense by the first week in June.  Twelve farms along the South Platte River  near Weldona, Kersey and Fort Morgan had been flooded and all reported substantial amounts of water in basements. 
## 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Ten to twelve buildings were reported damaged, including damage to roofs and chimneys. 
## 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Several trees and power lines were blown down just east of Niceville. 
## 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Roof sections from a home and garage were damaged with power lines down. 
## 7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           The Illinois State Police and storm spotters followed a tornado from the White Hall area to near Manchester.  The tornado lifted off the ground at times but did damage several farm buildings and trees as it traveled nearly parallel to Highway 267. 
## 8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Five to six homes were damaged and trees and power lines were blown down. 
## 9                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         A tornado briefly touched down on the western side of town and lifted the roof off a business.  In one area where several homes were damaged, a recreational vehicle was picked up and set down in the middle of a destroyed house.  Trees and large branches were also downed and large hail was also reported by local law enforcement. 
## 10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Several homes southeast of Columbia sustained minor roof damage. 
## 11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Lightning struck house occupied by sleeping elderly couple aged 90 and 91 years.  The bolt started the house on fire and damaged elctrical equipment.  Total damage costs estimated around $3,500. 
## 12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   An intense early morning thunderstorm caused numerous lightning strikes.  It took more than 100 firefighters from 19 communities many hours to extinguish a fire started by lightning which destroyed a large barn at a dairy farm in Westport.  Fires also were reported in a garage at another Westport home and at a house and garage in the neighboring town of Dartmouth. 
## 13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Numerous roads were closed due to flash flooding across northern sections of the county.  Interstate 70 was closed between Bermuda Road and Lucas/Hunt for several hours.  A few motorists were briefly trapped in the rising water. 
## 14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Business roof damage. 
## 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Lightning struck a church in Ambridge and set fire to the wooden timbers in the roof.  A nearby home was also struck with lightning, resulting in an attic fire. 
## 16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Central, North-,Flooding, resulting from snowmelt from the two major snowstorms in Central and,April and saturated soils, caused extensive road damage and inundation. Northeast SD,This caused several road closings and numerous flooded basements in many counties.  In addition, many lakes were overfull in Day and Campbell Counties.  Flooded farmland caused severe delays in small grain planting.  Spink, Sully, McPherson, and Brown Counties were declared disasters in April. 
## 17                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
## 18                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Several cars were damaged by the hail. 
## 19                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Several cars were damaged and windows were broken. 
## 20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
## 21                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      A few houses were damaged.  Numerous trees were blown down. 
## 22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Several homes and several hundered vehicle were damaged. 
## 23                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
## 24                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 A large awning for a shopping center was torn off.  A hotel had a 25 foot X 25 foot section of its roof torn off.  Many trees and power lines were knocked down. 
## 25                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
## 26                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
## 27                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Lightning set fire to two homes, causing approx $65K damage to one and $70K damage to another. 
## 28                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
## 29                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Numerous barns in and around St. Rose sustained damage and grain bins were toppled over.  Power lines were also knocked down with power outages in Trenton and New Baden. 
## 30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Large tree limbs and power lines were knocked down at Godfrey.  As the storm hit Alton, large trees fell demolishing a bandstand and heavily damaging at least three homes. 
## 31                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Numerous trees were snapped off and roofs damaged south of Odin while a mobile home south of Salem was completely destroyed.  Several stores in Centralia also had broken windows and trees were blown down damaging parked cars. 
## 32                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   The powerful storm that caused high winds across Oregon also spawned the most powerful tornado in the state in many years.  The tornado occurred as the coldfront associated with a deep surface low along the coast moved across the Willamette Valley in mid-afternoon.  The tornado touched down southeast of Newburg and heavily damaged a dairy farm, toppling large trees, killing six veal calves, and destroying calf shelters.  The tornado then proceeded northeasterly to a horseranch, where roofs were blown off some small buildings and extensive damage was done by flying debris, including some very large trees that were snapped off and uprooted.  The tornado next damaged the roof of a house and some nearby structures and then crossed the Willamette River. Passing motorists reported seeing the funnel sucking water up from the river.  After uprooting more trees and damaging a mobile home, the tornado apparently skipped a few miles northeast where it touched down near a mobile home park and caused extensive damage to mobile homes there. Near the northern end of the twisters path a tree at least 24 inches in diameter was snapped off six feet above ground and, along with other debris, hit a two story home and moved it off its foundation.  Incredibly, no one was injured. 
## 33                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            The roof of the New Haven Police Department and radio tower suffered extensive damage.  Large trees were also blown down and uprooted in the Leslie and Gerald areas. 
## 34                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Up to eight inches of rain in a three hour period caused the worst flash flood ever along the Meherrin River in the town of Severn. Between 15 and 20 residences were damaged significantly by the flood, with water window high in many of these homes. Damage also occurred at the local sewage treatment plant. 
## 35                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Over 40 building suffered structural damage to them.  A few trees were knocked down.  A man was injured in Liberty Hill as he sought shelter in his camp trailer.  Eight power poles were blown down. 
## 36                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Several houses had windows broken and numerous cars were damaged. 
## 37                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             A home was destroyed by a fire started by lightning. 
## 38                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Several homes and several hundered vehicle were damaged.
```


To begin with, the multipliers will make no difference to a bunch of entries where the damage in `PROPDMG` is recorded as 0.0, even though it is clear in most of the accompanying remarks that there was, indeed, damage. But even for those cases with nonzero figures, the remarks are not easy to reconcile to the figures. For example, the entry labeled `## 2` in the output above mentions several destroyed buildings including a home valued at $250,000 to $300,000. However, the propery damage is recorded as PROPDMG = 1.7 and PROPDMGEXP = 5. Note that $1.7 \times 10^5$ is 170,000, nowhere near high enough. Similar problems exist in trying to reconcile most of the other damage figures above with remarks that seem off by orders of magnitude.

Given the relatively small number of cases involved here, it seems best to ignore the mysterious entries and focus on the cases with "k", "K", "m", "M", and "B". (Anything else will get assigned to 1 so that the multiplier causes no change in the value.) We will do this with `PROPDMG` and `CROPDMG`.


```r
PROPDMGEXP_value <- sapply(storm_data$PROPDMGEXP,
    function(x) {switch(x,  "k" = 1000, "K" = 1000,
                            "m" = 1000000, "M" = 1000000, 
                            "B" = 1000000000, 1)})

CROPDMGEXP_value <- sapply(storm_data$CROPDMGEXP,
    function(x) {switch(x,  "k" = 1000, "K" = 1000,
                            "m" = 1000000, "M" = 1000000, 
                            "B" = 1000000000, 1)})
storm_data <- storm_data %>%
    mutate(PROPDMG_value = PROPDMGEXP_value,
           CROPDMG_value = CROPDMGEXP_value,
           PROPDMG_actual = PROPDMG * PROPDMG_value,
           CROPDMG_actual = CROPDMG * CROPDMG_value)
rm(PROPDMGEXP_value)
rm(CROPDMGEXP_value)
```


## Results

### 1. Across the United States, which types of events (as indicated in the `EVTYPE` variable) are most harmful with respect to population health?

First, we get totals for all the quantities of interest.


```r
storm_impact <- storm_data %>%
    group_by(EVTYPE) %>%
    summarize(Fatalities = sum(FATALITIES),
              Injuries = sum(INJURIES),
              Property_damage = sum(PROPDMG_actual),
              Crop_damage = sum(CROPDMG_actual))
```


Simple tables suffice here. We look at the top 10 events that have caused the most fatalities and injuries respectively.


```r
storm_impact %>%
    select(EVTYPE, Fatalities) %>%
    arrange(desc(Fatalities)) %>%
    head(10) %>%
    format(big.mark = ",") %>%
    knitr::kable("markdown", align = c('l', 'r'))
```



|EVTYPE         | Fatalities|
|:--------------|----------:|
|TORNADO        |      5,633|
|EXCESSIVE HEAT |      1,903|
|FLASH FLOOD    |        978|
|HEAT           |        937|
|LIGHTNING      |        816|
|TSTM WIND      |        504|
|FLOOD          |        470|
|RIP CURRENT    |        368|
|HIGH WIND      |        248|
|AVALANCHE      |        224|

```r
storm_impact %>%
    select(EVTYPE, Injuries) %>%
    arrange(desc(Injuries)) %>%
    head(10) %>%
    format(big.mark = ",") %>%
    knitr::kable("markdown", align = c('l', 'r'))
```



|EVTYPE            | Injuries|
|:-----------------|--------:|
|TORNADO           |   91,346|
|TSTM WIND         |    6,957|
|FLOOD             |    6,789|
|EXCESSIVE HEAT    |    6,525|
|LIGHTNING         |    5,230|
|HEAT              |    2,100|
|ICE STORM         |    1,975|
|FLASH FLOOD       |    1,777|
|THUNDERSTORM WIND |    1,488|
|HAIL              |    1,361|

It is clear that tornadoes are by far the most destructive natural force when it comes to safety and human life.


```r
tornadoes <- storm_data %>%
    filter(EVTYPE == "TORNADO") %>%
    group_by(Year = year(date)) %>%
    summarize(Fatalities = sum(FATALITIES), Injuries = sum(INJURIES))
g1 <- ggplot(tornadoes, aes(x = Year, y = Fatalities)) +
    ggtitle("Tornadoes in the U.S. (1950-2011)") +
    xlab(NULL) +
    scale_x_continuous(breaks=seq(1950,2011,10)) +
    geom_line()
g2 <- ggplot(tornadoes, aes(x = Year, y = Injuries)) +
    scale_x_continuous(breaks=seq(1950,2011,10)) +
    geom_line()
multiplot(g1, g2)
```

![plot of chunk unnamed-chunk-10](./repdata-005_Project_2_files/figure-html/unnamed-chunk-10.png) 

The figure shows that there are specific years in which tornadoes are particularly devastating. In particular, 2011 was one of the worst years on record. (See [this Wikipedia page](https://en.wikipedia.org/wiki/April_25%E2%80%9328,_2011_tornado_outbreak#April_27_event).)

### 2. Across the United States, which types of events have the greatest economic consequences?

We look at similar tables for property damage and crop damage (in dollars) to assess economic impact.


```r
options(scipen = 10)
storm_impact %>%
    select(EVTYPE, Property_damage) %>%
    arrange(desc(Property_damage)) %>%
    head(10) %>%
    format(big.mark = ",") %>%
    knitr::kable("markdown", align = c('l', 'r'))
```



|EVTYPE            | Property_damage|
|:-----------------|---------------:|
|FLOOD             | 144,657,709,807|
|HURRICANE/TYPHOON |  69,305,840,000|
|TORNADO           |  56,937,160,779|
|STORM SURGE       |  43,323,536,000|
|FLASH FLOOD       |  16,140,812,067|
|HAIL              |  15,732,267,048|
|HURRICANE         |  11,868,319,010|
|TROPICAL STORM    |   7,703,890,550|
|WINTER STORM      |   6,688,497,251|
|HIGH WIND         |   5,270,046,295|

```r
storm_impact %>%
    select(EVTYPE, Crop_damage) %>%
    arrange(desc(Crop_damage)) %>%
    head(10) %>%
    format(big.mark = ",") %>%
    knitr::kable("markdown", align = c('l', 'r'))
```



|EVTYPE            |    Crop_damage|
|:-----------------|--------------:|
|DROUGHT           | 13,972,566,000|
|FLOOD             |  5,661,968,450|
|RIVER FLOOD       |  5,029,459,000|
|ICE STORM         |  5,022,113,500|
|HAIL              |  3,025,954,473|
|HURRICANE         |  2,741,910,000|
|HURRICANE/TYPHOON |  2,607,872,800|
|FLASH FLOOD       |  1,421,317,100|
|EXTREME COLD      |  1,292,973,000|
|FROST/FREEZE      |  1,094,086,000|

There is a difference in the weather event taking the top spot for property damage versus crop damage.  Floods cause more than double the amount of property damage than the next highest event (hurricane/typhoon). Flooding also causes a lot of crop damage, but drought is more than twice as damaging to crops.
